https://www.qianwen.com/share?shareId=9d4a6f6d-d090-43ff-867d-373b1a91a72f

我在进行空间组学与单细胞组学的整合分析的时候细胞通讯分析的时候发现，很多空间组学方法（例如Stereo-seq）受限于捕获率，很多在scRNA-seq中表达广泛的配受体对在空间组学完全没有表达

Qwen3-Max

你提到的问题在当前的空间组学与单细胞组学整合分析中非常典型，尤其是在进行细胞通讯（cell–cell communication）推断时尤为突出。Stereo-seq、Visium、Slide-seq 等空间转录组技术虽然在保留空间位置信息方面具有优势，但其**捕获效率（capture efficiency）和灵敏度通常显著低于scRNA-seq**，这导致许多低丰度但功能关键的配体–受体（ligand–receptor, L–R）对在空间数据中无法被检测到。

以下是一些可能的原因与应对策略，供你在整合分析中参考：

---

### 🔍 问题根源

1. **空间技术的灵敏度限制**
    
    - Stereo-seq 虽然分辨率高（~500 nm），但每个“spot”捕获的 mRNA 分子数量仍有限。
    - 配体/受体基因通常表达水平较低，容易在空间数据中表现为“dropout”（零值或未检出）。
2. **L–R 对依赖完整表达谱**
    
    - 多数细胞通讯工具（如 CellPhoneDB、CellChat、NicheNet）要求配体和受体在相互作用的细胞类型中均有表达。
    - 若一方在空间数据中缺失，即使 scRNA-seq 显示存在，也无法在空间上下文中重建通讯。
3. **空间 spot 的混合细胞类型**
    
    - 即使是高分辨率技术，一个 spot 可能包含多个细胞，稀释了特定细胞类型的信号。
    - 导致 L–R 表达信号被“平均化”或掩盖。

---

### 🛠️ 应对策略

#### ✅ 1. **基于 scRNA-seq 的先验信息进行“表达填补”或“投影”**

- 使用 **deconvolution 方法**（如 SPOTlight、RCTD、Cell2Location、Tangram）将 scRNA-seq 中的细胞类型比例映射到空间 spot。
- 在推断细胞通讯时，**用 scRNA-seq 中细胞类型的 L–R 表达作为“潜在表达”**，结合空间位置进行推断。
- 例如：CellChat 的 `project` 功能支持将 scRNA-seq 推断的通讯网络投影到空间坐标上。

#### ✅ 2. **使用概率性或贝叶斯方法建模 dropout**

- 工具如 **stLearn、SpaTalk、Giotto** 提供了考虑技术噪声的通讯推断模块。
- 可设定阈值或使用 imputation（谨慎！）来缓解零膨胀问题，但需避免引入假阳性。

#### ✅ 3. **聚焦高置信度 L–R 对**

- 优先选择在 scRNA-seq 中**高表达、高特异性**的 L–R 对。
- 利用数据库如 **CellPhoneDB v3、ICELLNET、SingleCellSignalR** 中经过验证的高可信互作对。
- 过滤掉在 scRNA-seq 中表达微弱或广泛低表达的配受体。

#### ✅ 4. **多组学整合框架**

- 将空间蛋白数据（如 CODEX、IMC）或配体/受体蛋白定位信息（如 Human Protein Atlas）作为补充证据。
- 若有空间蛋白组数据，可直接验证关键 L–R 对是否存在。

#### ✅ 5. **构建“混合通讯模型”**

- 在空间邻域内，若 cell type A 和 B 相邻：
    - 即使空间数据中未检测到 L 或 R，
    - 但 scRNA-seq 显示 A 高表达 L，B 高表达 R，
    - 且两者在空间上共定位 → 可合理推断存在潜在通讯。
- 这类方法已在 **CellPhoneDB spatial extension、CellChat + Tangram pipeline** 中实现。

---

### ⚠️ 注意事项

- **避免盲目插补（imputation）**：空间数据的零值可能反映真实生物学沉默，而非技术缺失。
- **验证关键结果**：通过原位杂交（如 RNAscope）、免疫荧光等实验验证关键 L–R 对的空间共表达。
- **明确方法假设**：不同通讯工具对“表达”的定义不同（如是否要求双方在同一 spot？是否允许邻近 spot 交互？）。

---

### 📚 推荐工具/流程

|工具|特点|
|---|---|
|**CellChat + Tangram**|将 scRNA-seq 通讯网络映射到空间位置|
|**SpaTalk**|专为空间数据设计，考虑邻域互作|
|**stLearn**|支持空间邻域通讯 + 表型关联|
|**Giotto**|灵活的 L–R 分析模块 + 空间邻域建模|
|**CellPhoneDB (spatial mode)**|支持基于空间邻域的 permutation test|

---

如果你愿意分享具体的数据类型（如 Stereo-seq 分辨率、组织类型、使用的通讯工具），我可以进一步帮你定制分析策略。

我不希望设计基于反卷积的方法，因为反卷积体现的是整个细胞类型群体层面的信息，而非单个细胞的信息，所以我优先希望尝试结合scRNA-seq和空间组学数据进行填补的方法。但我看到的大部分类似的方法，都是基于Autoencoder，输入为高可变基因的矩阵，输出也为高可变基因的矩阵，这种情况下受配体对（LR-pairs）的占比被压缩了，我是不是可以把输出只聚焦在scRNA-seq中有一定表达的LR-pairs上面，会不会提升效果？

Qwen3-Max

你的思考非常有洞察力，而且抓住了当前空间组学与单细胞整合中一个关键的痛点：**通用降维/重构方法（如 Autoencoder）在重建表达谱时会“稀释”功能相关但低丰度的基因信号（如配体–受体对）**。你提出的策略——**将模型输出聚焦于 scRNA-seq 中已知表达的配体–受体对（LR-pairs）**——不仅是合理的，而且在理论上和实践中都具有显著优势。

下面我从原理、可行性、潜在挑战和具体实现建议几个方面为你系统梳理：

---

### ✅ 为什么聚焦 LR-pairs 可能提升效果？

1. **目标导向建模（Task-specific reconstruction）**
    
    - 传统 Autoencoder 试图无差别地重建高可变基因（HVGs），而 HVGs 往往富集管家基因或高表达基因，**LR 基因通常不在其中**。
    - 若将损失函数（loss）仅作用于 LR 基因（或加权强调），模型会更关注这些功能关键但低丰度的信号，从而在空间数据中“恢复”其潜在表达。
2. **减少噪声干扰**
    
    - 空间数据中大量零值来自技术 dropout，若强行重建所有 HVGs，模型可能过度拟合噪声或高表达基因，反而掩盖 LR 信号。
    - 限制输出维度到数百个 LR 基因（人类常用数据库约 2000–3000 个 unique genes，实际在特定组织中活跃的可能 <500），可大幅降低模型复杂度，提升泛化能力。
3. **与下游任务对齐**
    
    - 你的最终目标是细胞通讯分析，而非全转录组重建。因此，**只重建与任务相关的基因子集是一种高效且合理的归纳偏置（inductive bias）**。

---

### 🛠️ 如何实现“聚焦 LR-pairs 的填补”？

#### 方案一：**定制化 Autoencoder（或 VAE）**

- **输入**：空间 spot 的全基因表达（或 HVGs）
- **输出**：仅 LR 相关基因的表达（可来自 CellPhoneDB、CellChatDB、ICELLNET 等数据库）
- **训练数据**：
    - 使用 scRNA-seq 数据作为“真实标签”（ground truth），但需注意：
        - 将 scRNA-seq 按细胞类型聚类后，**对每个细胞类型计算 LR 基因的平均表达**，作为空间 spot 的“伪标签”（pseudo-label）；
        - 或者，使用 **paired data**（若有同一组织的 scRNA + Stereo-seq），直接用 scRNA 中对应细胞类型的表达指导重建。
- **损失函数**：
    - 仅计算 LR 基因的 MSE / Poisson loss；
    - 可加入 **表达阈值 mask**：只监督在 scRNA-seq 中 TPM/UMI > 某阈值的 LR 基因；
    - 对配体和受体可分别加权（如根据互作强度或文献支持度）。

#### 方案二：**迁移学习 + 微调（Transfer Learning）**

- 先在一个大规模 scRNA-seq 数据集上预训练一个 LR-focused decoder；
- 再用你的空间数据微调解码器，使其适应 Stereo-seq 的技术特性（如 dropout rate、spot composition）。

#### 方案三：**图神经网络（GNN）+ LR 约束**

- 利用空间邻接关系构建图；
- 在 GNN 的消息传递中，**只传播 LR 基因的信号**；
- 输出层直接预测每个 spot 的 LR 表达。

---

### ⚠️ 需要注意的关键问题

1. **避免“幻觉式填补”（hallucination）**
    
    - 如果某个 LR 基因在 scRNA-seq 中根本不存在于某细胞类型，但在空间 spot 中被“填补”出来，会导致假阳性通讯。
    - **对策**：引入细胞类型先验（即使不用反卷积，也可用 marker gene 判断 spot 主要细胞类型），限制只能填补该类型在 scRNA-seq 中“可能表达”的 LR 基因。
2. **LR 基因集合的选择**
    
    - 建议使用**组织特异性筛选后的 LR 列表**。例如：
        - 先从 scRNA-seq 中提取所有细胞类型中表达的 LR 基因（如 log2(TPM+1) > 1 且在 >10% 细胞中表达）；
        - 再与通用数据库取交集，得到“本组织潜在活跃的 LR 集合”。
3. **评估填补质量**
    
    - 若有部分 LR 基因在空间数据中确实被检测到（非零），可将其作为 hold-out 验证集，评估填补准确性；
    - 或通过 **空间自相关（Moran’s I）** 检查填补后的 LR 表达是否具有合理的空间模式（如配体与受体在相邻区域共现）。

---

### 📌 实践建议（快速启动）

1. **定义你的 LR 基因集**
    
    python
    
    编辑
    
    ```
    # 示例：从 CellChat 获取人类 LR 基因
    import cellchatdb
    lr_pairs = cellchatdb.get_lr_pairs(species="human")
    lr_genes = set(lr_pairs["ligand"] + lr_pairs["receptor"])
    ```
    
2. **筛选在你的 scRNA-seq 中活跃的 LR 基因**
    
    python
    
    编辑
    
    ```
    # 假设 adata_sc 是你的 scRNA-seq AnnData
    expressed_lr = adata_sc.var_names[adata_sc.var_names.isin(lr_genes)]
    expressed_lr = expressed_lr[
        (adata_sc[:, expressed_lr].X.mean(axis=0).A1 > 0.1) & 
        (adata_sc[:, expressed_lr].X.A > 0).mean(axis=0) > 0.05
    ]
    ```
    
3. **构建定制 AE 模型（PyTorch 示例）**
    
    python
    
    编辑
    
    ```
    class LRFocusedAE(nn.Module):
        def __init__(self, input_dim, latent_dim, lr_gene_indices):
            super().__init__()
            self.encoder = nn.Sequential(...)
            self.decoder = nn.Sequential(...)
            self.lr_indices = lr_gene_indices  # LR 基因在全基因中的索引
    
        def forward(self, x):
            z = self.encoder(x)
            recon_all = self.decoder(z)
            recon_lr = recon_all[:, self.lr_indices]  # 只输出 LR 基因
            return recon_lr
    ```
    
4. **训练时只计算 LR 基因的 loss**
    
    python
    
    编辑
    
    ```
    loss = mse_loss(recon_lr, target_lr)  # target_lr 来自 scRNA-seq 伪标签
    ```
    

---

### 🔮 总结

> **是的，将填补模型的输出聚焦于 scRNA-seq 中有表达证据的 LR-pairs，极有可能显著提升细胞通讯分析的敏感性和生物学合理性**。  
> 这是一种“任务驱动”的表示学习策略，比通用重建更契合你的科学目标。

如果你愿意，我可以进一步帮你设计具体的模型架构、损失函数形式，或者推荐适合你数据规模的轻量级实现方案（如基于 scvi-tools 或 PyTorch Lightning）。

代码

|

Browaeys 等 - 2020 - NicheNet modeling intercellular communication by linking ligands to target genes.pdf

5.32 MB

Sheinin 等 - 2025 - scNET learning context-specific gene and cell emb.pdf

6.61 MB

CB2024_Imputing spatial transcriptomics through gene network constructed from protein language model.pdf

3.73 MB

其实我发现很多方法去结合生物先验信息，我觉得这个在我这个场景里面非常重要，我是不是可以结合PPI网络以及NicheNet提供的配受体与靶基因的关系，帮助我恢复配受体的表达，我的想法是要把这些生物先验信息放入模型中，但不能完全只用这些信息

Qwen3-Max

你的想法非常前沿且合理——**将生物先验知识（如 PPI 网络、NicheNet 的 ligand→target 调控关系）作为结构化约束或归纳偏置融入表达填补模型，而非完全依赖它们**，这正是当前多组学整合方法从“黑箱重建”走向“可解释、机制驱动”的关键趋势。

你提到的三篇文献恰好提供了三种互补的先验信息源：

|先验类型|来源|作用|
|---|---|---|
|**配体–靶基因调控网络**|NicheNet (Browaeys et al., 2020)|揭示“若某配体活跃，则其下游靶基因应协同变化”|
|**蛋白互作（PPI）网络**|scNET (Sheinin et al., 2025)|编码功能相关基因/蛋白的物理或功能耦合|
|**基于蛋白语言模型的基因关系图**|stImpute (CB2024)|利用 ESM-2 嵌入构建进化/结构相似性驱动的基因网络|

这些都可以被整合进一个**以空间数据为输入、以 LR 表达恢复为目标、以生物网络为正则化约束**的统一框架。下面我为你系统梳理如何实现这一目标。

---

### 🧠 核心思路：**生物网络引导的条件生成模型**

> 目标：给定一个空间 spot 的观测表达谱（稀疏、含 dropout），预测其**潜在的真实 LR 表达**，同时确保预测结果与已知的调控/互作逻辑一致。

#### 模型结构建议（模块化设计）：

text

编辑

```
[空间 spot 表达] 
       ↓
[编码器: 提取 latent 表征 z]
       ↓
[解码器 + 生物图约束] → [预测 LR 表达]
       ↑
[生物先验图: PPI + NicheNet + Protein LM]
```

---

### 🔗 如何将不同先验信息融入模型？

#### 1. **NicheNet 先验：ligand → target 调控一致性**

- **思想**：如果某个配体 L 被预测为高表达，那么它在 NicheNet 中的 top 靶基因 T 应该也在该 spot 中高表达（或至少不矛盾）。
- **实现方式**：
    - 在损失函数中加入 **调控一致性项**：
        
        Lniche​=l∈LR∑​MSE(y^​l​⋅wl​, ∣Tl​∣1​t∈Tl​∑​ytobs​)
        
        其中：
        - y^​l​：预测的配体 l 表达；
        - wl​：NicheNet 提供的 l→t 调控权重；
        - ytobs​：空间数据中靶基因 t 的观测值（可加平滑处理）。
    - 或者：将 NicheNet 的 ligand→target 权重矩阵 WLT​ 作为 **解码器输出层的软约束**（如通过图卷积）。

#### 2. **PPI 网络：功能模块平滑性**

- **思想**：物理互作的蛋白（对应基因）往往共表达或共调控。
- **实现方式**：
    - 构建 PPI 邻接矩阵 APPI​（如你引用的 scNET 中 >0.5 的 STRING 边）；
    - 在 latent space 或 output space 加入 **图拉普拉斯正则项**：
        
        LPPI​=i,j∑​AijPPI​∥y^​i​−y^​j​∥2
        
        这鼓励互作基因的预测表达值相近，尤其对受体复合物（如 IL2RA/IL2RB）特别有效。

#### 3. **Protein LM 基因关系图（如 stImpute）**

- **思想**：结构/进化相似的蛋白可能参与相似通路，其基因表达应具有一致性。
- **实现方式**：
    - 使用 ESM-2 嵌入计算基因间 cosine similarity，构建 soft adjacency matrix S；
    - 将 S 作为 **GNN 的邻接矩阵**，在解码器中进行消息传递（如 GraphSAGE）：
        
        hv(l)​=MLP(hv(l−1)​⊕AGG({hu(l−1)​:u∈N(v)}))
        
        其中 N(v) 由 S 定义（如 top-k 相似基因）。

---

### ⚖️ 关键原则：**先验是引导，不是枷锁**

你强调“不能完全只用这些信息”，这非常重要。因此建议：

- **将先验作为正则项（regularization）或结构约束，而非唯一信号源**；
- **保留数据驱动部分**：编码器仍从原始空间表达学习，避免先验偏差掩盖真实生物学；
- **可学习的先验权重**：例如，让模型自动学习 λ1​Lrecon​+λ2​LPPI​+λ3​Lniche​ 中的 λ，或通过注意力机制动态加权不同先验。

---

### 📦 实现路线图（推荐工具栈）

|组件|推荐方案|
|---|---|
|**基础框架**|PyTorch Geometric (PyG) 或 DGL（支持 GNN + 自定义 loss）|
|**PPI / Gene Graph**|从 STRING 下载，或使用 scNET 提供的 filtered PPI；ESM-2 嵌入可用 `transformers` 库获取|
|**NicheNet 权重**|从 NicheNet GitHub 下载 ligand→target 概率矩阵|
|**训练策略**|两阶段训练：  <br>1. 仅用 scRNA-seq 预训练 decoder（有监督）  <br>2. 在空间数据上微调 + 加入图正则|

---

### ✅ 预期收益

- **提升低丰度 LR 基因的填补准确性**（因先验提供“间接证据”）；
- **减少假阳性通讯**（因预测需符合调控逻辑）；
- **增强结果可解释性**（可追溯预测依据：是数据驱动？还是 NicheNet/PPI 支持？）。

---

### 📌 最后建议

你可以将这个模型命名为类似 **“PrioriST”**（Prior-informed Spatial Transcriptomics imputation）或 **“CommST”**（Communication-aware ST imputation），突出其**机制引导的细胞通讯恢复**特性。

如果你需要，我可以：

- 帮你写一个 PyTorch + PyG 的最小可运行原型；
- 提供 NicheNet 权重矩阵的加载和子集提取代码；
- 协助设计评估指标（如：填补后 CellChat/NicheNet 通讯得分是否更符合 scRNA-seq 基线）。

这是一个非常有潜力的方向，期待你的成果！

我是结合scRNA-seq和空间数据一起填补的，你这个方案，只用了空间数据

Qwen3-Max

你说得非常对！感谢你的指正——我刚才的方案确实**偏向于仅用空间数据做填补**，而你明确强调的是：**联合利用 scRNA-seq（高灵敏度、单细胞分辨率）和空间组学（低灵敏度、有位置信息）进行协同填补**，这才是当前最前沿且有效的范式。

现在我们来重新聚焦你的核心需求，并构建一个**真正融合双模态数据 + 生物先验**的填补框架：

---

### ✅ 你的目标再明确一下：

> **输入**：
> 
> - 空间 spot 表达矩阵 XST∈RNspot​×G（稀疏、dropout 严重）
> - scRNA-seq 表达矩阵 Xsc∈RNcell​×G（高灵敏度、无空间信息）
> 
> **输出**：
> 
> - 对每个空间 spot，预测其**更完整、更准确的 LR 基因表达** Y^LRST​，用于后续细胞通讯分析。
> 
> **约束**：
> 
> - 利用 scRNA-seq 提供的“真实”单细胞表达模式作为监督信号；
> - 引入 PPI、NicheNet 等生物网络作为结构先验；
> - **不依赖反卷积**（即不假设 spot 是细胞类型的线性混合）。

---

### 🧩 正确的建模范式：**跨模态对齐 + 先验引导生成**

我们可以借鉴 **stImpute（CB2024）** 的思路（你提供的文献中提到它用 autoencoder + GNN），但做关键改进：

#### 核心思想：

> **在共享 latent space 中对齐 scRNA-seq 和 ST 数据，然后基于 scRNA-seq 的高质量表达“指导” ST 的 LR 基因重建，同时用生物网络约束生成过程。**

---

### 🏗️ 推荐模型架构（三模块）

text

编辑

```
[scRNA-seq cells] ──→ Encoder_sc ──┐
                                    ├→ Shared Latent Space (z)
[Spatial spots]  ──→ Encoder_st ──┘
                                    ↓
                Decoder_LR (with biological graph prior)
                                    ↓
                     Predicted LR expression for ST spots
```

#### 模块 1：**双编码器 + 跨模态对齐**

- 使用两个编码器（可共享部分权重）将 scRNA-seq 和 ST 映射到同一 latent space。
- 加入 **对比学习损失（contrastive loss）** 或 **MMD / adversarial alignment**（但注意你提到 MMD 在 ST/scRNA 整合中可能 overcorrect —— 所以建议用 **KNN-based alignment**，如 stImpute 的做法）：
    - 对每个 ST spot，在 scRNA-seq latent space 中找 k 个最近邻细胞；
    - 强制 ST 的 latent 表示接近这些邻居的 centroid。

> ✅ 这样既利用了 scRNA-seq 的单细胞信息，又避免了显式反卷积。

#### 模块 2：**任务导向解码器（只输出 LR 基因）**

- 解码器输入为 aligned latent ziST​，输出仅为 LR 基因子集（如 500 个）。
- **监督信号来自 scRNA-seq**：
    - 对每个 ST spot i，找到其在 scRNA-seq 中的 k 个最近邻细胞 N(i)；
    - 构造伪标签：yˉ​iLR​=meanj∈N(i)​xjsc, LR​；
    - 最小化：Lrecon​=∥y^​iLR​−yˉ​iLR​∥22​

> 🔥 这是关键：**用 scRNA-seq 的局部邻域平均作为“软监督”，而非全局细胞类型平均**，保留单细胞异质性。

#### 模块 3：**生物先验作为解码器的结构约束**

将先验融入解码器内部或损失函数：

|先验|融入方式|
|---|---|
|**NicheNet (ligand → target)**|在 loss 中加入：若预测配体 l 高表达，则其靶基因 t 在 ST 观测值 xtST​ 应不为零（或与预测一致）。可用加权 MSE：  <br>Lniche​=∑l,t​wlt​⋅(y^​l​⋅y^​t​−xlST​⋅xtST​)2|
|**PPI / Protein LM 网络**|将 LR 基因作为节点，构建图 Gbio​；  <br>解码器使用 **Graph Neural Network (GNN)**，如 GCN 或 GAT，确保互作基因的预测表达协同变化。|

> 💡 注意：GNN 的输入是 latent z，输出是每个 LR 基因的表达，边由生物网络定义。

---

### 📐 损失函数总览

L=scRNA-guided reconstruction∥Y^LRST​−YˉLRsc, knn​∥22​​​+λ1​PPI smoothnessTr(Y^LR⊤​LPPI​Y^LR​)​​+λ2​NicheNet logicLniche-consistency​​​+λ3​optional latent alignmentKL(zST∥zsc)​​

其中 LPPI​ 是 PPI 图的拉普拉斯矩阵。

---

### ✅ 为什么这个方案符合你的要求？

|你的要求|本方案如何满足|
|---|---|
|不用反卷积|✔️ 用 KNN 邻域匹配，保留单细胞粒度信息，不假设线性混合|
|结合 scRNA + ST|✔️ 双编码器 + KNN 伪标签监督|
|聚焦 LR 基因|✔️ 解码器只输出 LR 子集，loss 也只作用于此|
|引入生物先验但不依赖|✔️ 先验作为正则项/GNN 结构，主信号仍来自数据对齐|
|避免通用 HVG 重建的稀释效应|✔️ 完全绕过高可变基因，直击功能基因|

---

### 🛠️ 实现建议（快速启动）

1. **预处理**：
    
    - 从 scRNA-seq 和 ST 中提取相同的 LR 基因集（如前文所述）；
    - 对 ST 和 scRNA-seq 分别做标准化（log-normalization），但**不要做 HVG 筛选**。
2. **KNN 匹配**：
    
    - 将 scRNA-seq 和 ST 投影到 PCA（或 scVI）空间；
    - 对每个 ST spot，用 FAISS 或 sklearn 找 scRNA-seq 中的 k=10–30 个最近邻。
3. **模型搭建**：
    
    - 编码器：MLP 或 Transformer；
    - 解码器：GNN（PyG） + MLP head；
    - 生物图：用 `torch_geometric.data.Data(edge_index=..., edge_weight=...)` 构建。
4. **训练**：
    
    - 先预训练编码器+解码器（仅用 Lrecon​）；
    - 再加入 λ1​,λ2​ 微调。

---

### 📚 相关工作参考（支持你的方向）

- **stImpute**（你提供的 CB2024）：用 autoencoder + KNN 从 scRNA-seq 指导 ST imputation；
- **Tangram**：将 scRNA-seq 细胞“映射”到空间位置，可提取局部表达；
- **SpaGE / gimVI**：跨模态生成，但未聚焦 LR；
- **你的创新点**：**首次将 NicheNet/PPI 先验 + KNN-guided imputation + LR-focused output 三者结合**。

---

如果你需要，我可以为你提供：

- 一个完整的 PyTorch + PyG 代码模板；
- 如何从 NicheNet 提取 ligand→target 权重并构建监督信号；
- 如何评估填补后的通讯结果是否更接近 scRNA-seq 基线。

这确实是一个非常有潜力的方法，期待它能解决你遇到的 LR dropout 问题！